name: all actions

on:
    push:
        branches: ['**']
    workflow_dispatch:

jobs:
    build-next-playground:
        # uses: tomek-f/tf/.github/workflows/build-next-playground.yml
        uses: ./.github/workflows/build-next-playground.yml
        secrets: inherit
    build-react-playground:
        uses: ./.github/workflows/build-react-playground.yml
    build-tomekf:
        uses: ./.github/workflows/build-tomekf.yml
    build-pocs:
        uses: ./.github/workflows/build-pocs.yml
    vitest:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: ./.github/actions/vitest
    lint:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: ./.github/actions/lint
    prettier:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: ./.github/actions/prettier
    types:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: ./.github/actions/types
    bun-test:
        uses: ./.github/workflows/bun-test.yml

    deploy-next-playground:
        uses: ./.github/workflows/deploy-next-playground.yml
        secrets: inherit
        needs: [vitest, lint, prettier, types, build-next-playground]
    deploy-react-playground:
        uses: ./.github/workflows/deploy-react-playground.yml
        secrets: inherit
        needs: [vitest, lint, prettier, types, build-react-playground]
    preview-deploy-tomekf:
        if: github.ref != 'refs/heads/master'
        uses: ./.github/workflows/preview-deploy-tomekf.yml
        secrets: inherit
        needs: [vitest, lint, prettier, types, build-tomekf]

    production-deploy-tomekf:
        if: github.ref == 'refs/heads/master'
        uses: ./.github/workflows/production-deploy-tomekf.yml
        secrets: inherit
        needs: [vitest, lint, prettier, types, build-tomekf]
